# Resendドメイン設定ガイド

## 問題: resend.devドメインの制限

Resendの `resend.dev` ドメイン（`onboarding@resend.dev`）は**テスト用**で、以下の制限があります：

- **自分のメールアドレス（Resendアカウントのメールアドレス）にしか送信できない**
- 他のメールアドレスに送信しようとするとエラーになる

## 解決方法

### 方法1: 開発環境での対処（簡単）

開発環境では、通知先を自分のメールアドレスに設定します：

1. `/admin/settings/contact` にアクセス
2. 「通知先メールアドレス」に**自分のメールアドレス（Resendアカウントのメールアドレス）**を入力
3. 「保存」をクリック

これで、お問い合わせが届いた際に自分のメールアドレスに通知が届きます。

**`.env.local` の設定**:
```env
EMAIL_SERVICE=resend
EMAIL_API_KEY=re_xxxxxxxxxxxxx
EMAIL_FROM=onboarding@resend.dev
```

### 方法2: 本番環境での対処（ドメイン検証）

本番環境では、自分のドメインを検証して使用します：

#### ステップ1: ドメインを追加

1. Resendダッシュボードにログイン
2. 左側のメニューから「Domains」をクリック
3. 「Add Domain」をクリック
4. ドメイン名を入力（例: `yourdomain.com`）
5. 「Add」をクリック

#### ステップ2: DNSレコードを設定

Resendが表示するDNSレコードを、ドメインのDNS設定に追加します：

**例: Cloudflareの場合**
1. Cloudflareダッシュボードにログイン
2. ドメインを選択
3. 「DNS」→「Records」を開く
4. Resendが指定したレコードを追加：
   - **TXTレコード**: ドメイン検証用
   - **CNAMEレコード**: メール送信用

**例: その他のDNSプロバイダの場合**
- ドメインのDNS設定画面で、Resendが指定したレコードを追加

#### ステップ3: ドメインの検証を待つ

1. DNSレコードを設定後、Resendダッシュボードで「Verify」をクリック
2. 検証が完了するまで数分〜数時間かかる場合があります
3. 検証が完了すると、ドメインのステータスが「Verified」になります

#### ステップ4: 環境変数を更新

検証が完了したら、`.env.local` を更新：

```env
EMAIL_SERVICE=resend
EMAIL_API_KEY=re_xxxxxxxxxxxxx
EMAIL_FROM=noreply@yourdomain.com  # 検証済みドメインのメールアドレス
NEXT_PUBLIC_SITE_URL=https://yourdomain.com
```

#### ステップ5: 開発サーバーを再起動

```bash
npm run dev
```

## 確認方法

1. お問い合わせフォームから送信
2. 開発サーバーのコンソールでログを確認：
   - `[Email] Resend API レスポンス` で成功を確認
3. Resendダッシュボードの「Logs」セクションで送信履歴を確認
4. 通知先メールアドレスにメールが届いているか確認

## よくある質問

### Q: 開発環境でもドメインを検証する必要がありますか？

A: いいえ。開発環境では、通知先を自分のメールアドレスに設定すれば、`resend.dev` ドメインでも動作します。

### Q: ドメインの検証に時間がかかりますか？

A: DNSレコードの反映には数分〜数時間かかる場合があります。通常は30分以内に完了します。

### Q: 複数のドメインを検証できますか？

A: はい。Resendの無料プランでも複数のドメインを検証できます。

### Q: ドメインを検証しないとメール送信できませんか？

A: 開発環境では、`resend.dev` ドメインを使用して自分のメールアドレスに送信できます。本番環境では、ドメインの検証が必要です。
