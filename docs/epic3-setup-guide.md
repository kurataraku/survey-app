# Epic3 セットアップガイド

このガイドでは、Epic3の実装を完了するための手順を詳しく説明します。

---

## ステップ1: 依存関係のインストール

新しく追加したパッケージ（`react-markdown`と`remark-gfm`）をインストールします。

### 1-1. ターミナルを開く

1. VS Code（またはCursor）を開きます
2. メニューから「ターミナル」→「新しいターミナル」を選択
   - または `Ctrl + Shift + ` `（バッククォート）` でターミナルを開きます

### 1-2. プロジェクトディレクトリに移動

ターミナルで以下のコマンドを実行してください：

```bash
cd "C:\Users\taka-\OneDrive\デスクトップ\project\survey-app"
```

**注意**: コマンドプロンプト（cmd.exe）を使用することを推奨します。PowerShellで実行ポリシーエラーが出る場合は、VS Codeのターミナルで「コマンドプロンプト」を選択してください。

### 1-3. 依存関係をインストール

以下のコマンドを実行します：

```bash
npm install
```

### 1-4. インストールの確認

以下のようなメッセージが表示されれば成功です：

```
added 2 packages, and audited XXX packages in XXs
```

エラーが出た場合は、エラーメッセージの内容を確認してください。

---

## ステップ2: データベーススキーマの実行

Supabaseに新しいテーブル（`articles`と`article_schools`）を作成します。

### 2-1. Supabaseダッシュボードにアクセス

1. ブラウザで [Supabaseダッシュボード](https://app.supabase.com/) にアクセス
2. プロジェクトを選択（または新規作成）

### 2-2. SQL Editorを開く

1. 左側のメニューから「SQL Editor」をクリック
2. 「New query」ボタンをクリックして新しいクエリを作成

### 2-3. 最初のSQLファイルを実行（articlesテーブル）

1. プロジェクトの `supabase-schema-epic3-articles.sql` ファイルを開きます
   - VS Codeでファイルを開いて、すべての内容をコピー（`Ctrl + A` → `Ctrl + C`）
   
2. SupabaseのSQL Editorに貼り付け（`Ctrl + V`）

3. 「Run」ボタンをクリック、または `Ctrl + Enter` を押して実行

4. 以下のようなメッセージが表示されれば成功です：
   ```
   Success. No rows returned
   ```

### 2-4. 2番目のSQLファイルを実行（article_schoolsテーブル）

1. SQL Editorで新しいクエリを作成（「New query」ボタン）

2. プロジェクトの `supabase-schema-epic3-article-schools.sql` ファイルを開きます
   - すべての内容をコピー（`Ctrl + A` → `Ctrl + C`）

3. SupabaseのSQL Editorに貼り付け（`Ctrl + V`）

4. 「Run」ボタンをクリック、または `Ctrl + Enter` を押して実行

5. 成功メッセージが表示されることを確認

### 2-5. テーブルが作成されたことを確認

1. 左側のメニューから「Table Editor」をクリック

2. 以下のテーブルが表示されていることを確認：
   - `articles` - 記事テーブル
   - `article_schools` - 記事と学校の関連付けテーブル

---

## ステップ3: 開発サーバーの起動

### 3-1. 開発サーバーが起動しているか確認

ターミナルで `npm run dev` が実行されているか確認してください。

起動していない場合は、以下のコマンドを実行：

```bash
npm run dev
```

### 3-2. サーバーの起動を確認

以下のようなメッセージが表示されれば成功です：

```
▲ Next.js 16.1.1 (Turbopack)
- Local: http://localhost:3000
✓ Ready in X.XXs
```

ブラウザで `http://localhost:3000` にアクセスできることを確認してください。

---

## ステップ4: 動作確認

### 4-1. 管理画面（記事管理）の確認

1. ブラウザで以下のURLにアクセス：
   ```
   http://localhost:3000/admin/articles
   ```

2. 以下の機能を確認：
   - 記事一覧が表示される（初期状態では空の可能性があります）
   - 「新規作成」ボタンが表示される
   - 検索・フィルタ機能が動作する

### 4-2. 管理画面（学校管理）の確認

1. ブラウザで以下のURLにアクセス：
   ```
   http://localhost:3000/admin/schools
   ```

2. 以下の機能を確認：
   - 学校一覧が表示される
   - 各学校の「編集」ボタンが表示される
   - 検索機能が動作する

### 4-3. 特集ページ（フロントエンド）の確認

1. ブラウザで以下のURLにアクセス：
   ```
   http://localhost:3000/features
   ```

2. 以下の機能を確認：
   - 特集ページ一覧が表示される（初期状態では空の可能性があります）
   - カテゴリタブ（すべて、リアル体験談、お役立ち情報）が表示される

### 4-4. テスト記事の作成（オプション）

管理画面でテスト記事を作成して、フロントエンドで表示されることを確認：

1. `http://localhost:3000/admin/articles/new` にアクセス
2. 以下の情報を入力：
   - タイトル: 「テスト記事」
   - スラッグ: 「test-article」（自動生成される）
   - カテゴリ: 「リアル体験談 クチコミ・インタビュー」または「通信制高校お役立ち情報」
   - 本文: 任意のMarkdown形式のテキスト
   - 公開フラグ: ✅ チェック
3. 「保存」ボタンをクリック
4. `http://localhost:3000/features` に戻り、作成した記事が表示されることを確認
5. 記事をクリックして、詳細ページが正しく表示されることを確認

---

## エラーが発生した場合

### npm install でエラーが出る場合

- **エラー内容**: `npm ERR! code ENOENT`
- **対処法**: プロジェクトディレクトリにいることを確認してください

- **エラー内容**: `npm ERR! code ERESOLVE`
- **対処法**: 以下のコマンドを試してください：
  ```bash
  npm install --legacy-peer-deps
  ```

### SQL実行でエラーが出る場合

- **エラー内容**: `relation "articles" already exists`
- **対処法**: テーブルが既に存在している可能性があります。Table Editorで確認してください

- **エラー内容**: `permission denied`
- **対処法**: Supabaseのプロジェクト権限を確認してください

### 開発サーバーでエラーが出る場合

- **エラー内容**: `Port 3000 is already in use`
- **対処法**: 
  1. 既存のサーバーを停止（ターミナルで `Ctrl + C`）
  2. `.next` フォルダを削除
  3. `npm run dev` を再実行

- **エラー内容**: `Module not found: Can't resolve 'react-markdown'`
- **対処法**: `npm install` が正しく実行されていない可能性があります。再度実行してください

---

## 次のステップ

セットアップが完了したら、以下の機能を使用できます：

1. **記事管理**: `/admin/articles` で記事の作成・編集・削除
2. **学校管理**: `/admin/schools` で学校情報の編集と口コミ管理
3. **特集ページ**: `/features` で記事の閲覧

質問や問題があれば、お気軽にお知らせください。













