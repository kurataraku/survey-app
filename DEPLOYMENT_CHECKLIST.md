# デプロイ確認チェックリスト

このチェックリストを使用して、Vercelへのデプロイが正常に完了しているか確認してください。

## ✅ 1. Vercelダッシュボードでの確認

### ビルドログの確認

- [ ] Vercelダッシュボード（https://vercel.com/dashboard）にログイン
- [ ] プロジェクトを選択
- [ ] 「Deployments」タブを開く
- [ ] 最新のデプロイメントの状態が「Ready」であることを確認
- [ ] ビルドログにエラーがないことを確認
  - 「Build Logs」をクリック
  - エラーメッセージがないことを確認
  - 警告（Warning）があれば内容を確認

### 環境変数の確認

- [ ] 「Settings」タブをクリック
- [ ] 左メニューから「Environment Variables」を選択
- [ ] 以下の環境変数が設定されていることを確認：
  - [ ] `NEXT_PUBLIC_SUPABASE_URL` - 値が設定されている
  - [ ] `NEXT_PUBLIC_SUPABASE_ANON_KEY` - 値が設定されている
  - [ ] `SUPABASE_SERVICE_ROLE_KEY` - 値が設定されている
  - [ ] `NEXT_PUBLIC_SITE_URL` - 値が設定されている（オプション、SEO用）
- [ ] 各環境変数が以下の環境に設定されていることを確認：
  - [ ] Production
  - [ ] Preview
  - [ ] Development（必要に応じて）

**注意**: 環境変数を追加・変更した場合は、再デプロイが必要です。

---

## ✅ 2. 静的ページの動作確認

ブラウザでデプロイされたサイトにアクセスし、以下のページが正常に表示されるか確認してください。

### ホームページ

- [ ] サイトのURLを開く（例: `https://your-project.vercel.app`）
- [ ] ページが正常に読み込まれる
- [ ] ローディング中にスケルトンが表示される
- [ ] 以下のセクションが表示される：
  - [ ] ヒーローセクション（検索フォーム）
  - [ ] 注目の学校（3件表示）
  - [ ] 注目の口コミ（3件表示）
  - [ ] 特集記事（3件表示）
  - [ ] 都道府県別クイックアクセス

### 学校一覧ページ

- [ ] `/schools` にアクセス
- [ ] 学校一覧が表示される
- [ ] 検索機能が動作する
- [ ] 都道府県フィルターが動作する
- [ ] ページネーションが動作する（データが多い場合）

### 口コミ一覧ページ

- [ ] `/reviews` にアクセス
- [ ] 口コミ一覧が表示される
- [ ] フィルターが動作する
- [ ] ソート機能が動作する

### ランキングページ

- [ ] `/rankings` にアクセス
- [ ] ランキング一覧が表示される
- [ ] タブ（総合、スタッフ、雰囲気など）が動作する

### 特集記事一覧ページ

- [ ] `/features` にアクセス
- [ ] 記事一覧が表示される
- [ ] カテゴリーフィルターが動作する

---

## ✅ 3. SEOファイルの生成確認

### robots.txt

- [ ] `https://your-project.vercel.app/robots.txt` にアクセス
- [ ] 以下の内容が表示されることを確認：
  ```
  User-Agent: *
  Allow: /
  Disallow: /admin/
  Disallow: /api/
  Disallow: /export
  Disallow: /survey
  
  Sitemap: https://your-project.vercel.app/sitemap.xml
  ```

### sitemap.xml

- [ ] `https://your-project.vercel.app/sitemap.xml` にアクセス
- [ ] XML形式でsitemapが表示される
- [ ] 静的ページ（ホーム、学校一覧など）が含まれている
- [ ] 動的ページ（学校詳細、口コミ詳細など）が含まれている
- [ ] エラーがなく正常に読み込まれる

**注意**: sitemap.xmlが生成されない場合、環境変数 `NEXT_PUBLIC_SITE_URL` が設定されているか確認してください。

---

## ✅ 4. APIエンドポイントの動作確認

### ホームページAPI

- [ ] `https://your-project.vercel.app/api/home` にアクセス
- [ ] JSON形式でデータが返される
- [ ] 以下のプロパティが含まれている：
  - [ ] `topRankedSchools`（配列）
  - [ ] `popularSchools`（配列）
  - [ ] `latestReviews`（配列）
  - [ ] `latestArticles`（配列）
- [ ] エラーメッセージがない

### 学校検索API

- [ ] `https://your-project.vercel.app/api/schools/search?q=テスト` にアクセス
- [ ] JSON形式で検索結果が返される
- [ ] `schools` プロパティが配列で返される

### 学校オートコンプリートAPI

- [ ] `https://your-project.vercel.app/api/schools/autocomplete?q=テスト` にアクセス
- [ ] JSON形式で候補が返される
- [ ] `suggestions` プロパティが配列で返される

### 口コミ一覧API

- [ ] `https://your-project.vercel.app/api/reviews` にアクセス
- [ ] JSON形式で口コミ一覧が返される
- [ ] `reviews` プロパティが配列で返される

**注意**: APIエンドポイントがエラーを返す場合、環境変数が正しく設定されているか確認してください。

---

## ✅ 5. 動的ページの動作確認

### 学校詳細ページ

- [ ] `/schools` で学校を1つクリック
- [ ] 学校詳細ページ（`/schools/[slug]`）が表示される
- [ ] 以下の情報が表示される：
  - [ ] 学校名
  - [ ] 都道府県
  - [ ] 紹介文
  - [ ] 評価レーダーチャート
  - [ ] 統計情報
  - [ ] 最新の口コミ
- [ ] エラーがなく正常に読み込まれる

### 口コミ詳細ページ

- [ ] `/reviews` で口コミを1つクリック
- [ ] 口コミ詳細ページ（`/reviews/[id]`）が表示される
- [ ] 以下の情報が表示される：
  - [ ] 学校名
  - [ ] 総合満足度
  - [ ] 良い点
  - [ ] 改善点
  - [ ] その他の回答
- [ ] いいねボタンが動作する
- [ ] エラーがなく正常に読み込まれる

### 特集記事詳細ページ

- [ ] `/features` で記事を1つクリック
- [ ] 記事詳細ページ（`/features/[slug]`）が表示される
- [ ] 以下の情報が表示される：
  - [ ] タイトル
  - [ ] 本文
  - [ ] 関連学校一覧
- [ ] エラーがなく正常に読み込まれる

---

## ✅ 6. ブラウザコンソールエラーの確認

### ブラウザの開発者ツールで確認

1. **開発者ツールを開く**
   - Windows/Linux: `F12` キーまたは `Ctrl + Shift + I`
   - Mac: `Cmd + Option + I`

2. **Consoleタブでエラーを確認**
   - [ ] エラー（赤色）が表示されていない
   - [ ] 警告（黄色）があれば内容を確認
   - [ ] 404エラー（リソースが見つからない）がない

3. **Networkタブでリクエストを確認**
   - [ ] すべてのリクエストが正常に完了している（ステータスコード200）
   - [ ] 失敗したリクエスト（4xx、5xx）がない
   - [ ] APIリクエストが正常に完了している

4. **主要なページで確認**
   - [ ] ホームページ (`/`)
   - [ ] 学校一覧ページ (`/schools`)
   - [ ] 学校詳細ページ (`/schools/[slug]`)
   - [ ] 口コミ一覧ページ (`/reviews`)
   - [ ] 口コミ詳細ページ (`/reviews/[id]`)

---

## ✅ 7. パフォーマンスの確認

### ページ読み込み速度

- [ ] ホームページが3秒以内に読み込まれる（目標: 2.5秒以下）
- [ ] 学校一覧ページが3秒以内に読み込まれる
- [ ] 学校詳細ページが3秒以内に読み込まれる

### Lighthouseスコア（オプション）

1. **開発者ツールを開く**（`F12`）
2. **Lighthouseタブを開く**
3. **「Analyze page load」をクリック**
4. **以下のスコアを確認**（目標）：
   - [ ] Performance: 70以上
   - [ ] Accessibility: 90以上
   - [ ] Best Practices: 90以上
   - [ ] SEO: 90以上

---

## ✅ 8. 機能の動作確認

### 検索機能

- [ ] ホームページの検索フォームで学校名を検索できる
- [ ] オートコンプリート候補が表示される
- [ ] 検索結果ページに遷移できる
- [ ] 都道府県フィルターが動作する

### 口コミ投稿機能

- [ ] `/survey` にアクセスできる
- [ ] フォームが表示される
- [ ] すべてのステップが動作する
- [ ] 送信ボタンが動作する
- [ ] 送信後、確認メッセージが表示される

### いいね機能

- [ ] 口コミ詳細ページでいいねボタンをクリックできる
- [ ] いいね数が増える
- [ ] 再度クリックでいいねが解除される

---

## ❌ 問題が見つかった場合

### ビルドエラー

1. **ビルドログを確認**
   - Vercelダッシュボード → Deployments → Build Logs
   - エラーメッセージをコピー

2. **ローカルでビルドを実行**
   ```bash
   npm run build
   ```
   - ローカルでも同じエラーが出るか確認

3. **エラーを修正**
   - TypeScriptエラー: 型定義を修正
   - 依存関係エラー: `npm install` を実行
   - 環境変数エラー: `.env.local` を確認

### ページが表示されない

1. **ブラウザのコンソールでエラーを確認**
   - `F12` → Consoleタブ
   - エラーメッセージをコピー

2. **環境変数を確認**
   - Vercelダッシュボード → Settings → Environment Variables
   - すべての環境変数が設定されているか確認

3. **APIエンドポイントを直接確認**
   - `https://your-project.vercel.app/api/home` にアクセス
   - エラーメッセージが返されるか確認

### APIエラー

1. **環境変数を確認**
   - `NEXT_PUBLIC_SUPABASE_URL`
   - `NEXT_PUBLIC_SUPABASE_ANON_KEY`
   - `SUPABASE_SERVICE_ROLE_KEY`

2. **Supabaseダッシュボードで確認**
   - プロジェクトがアクティブか確認
   - テーブルが存在するか確認
   - RLSポリシーが正しく設定されているか確認

3. **APIログを確認**
   - Vercelダッシュボード → Functions → Logs
   - エラーログを確認

---

## 📝 確認結果の記録

### 確認日時

- [ ] 確認日: ___________ / ___________
- [ ] 確認者: ___________

### 確認結果

- [ ] すべての項目を確認完了
- [ ] 問題が発見された場合は以下に記録

#### 発見された問題

1. **問題の種類**: ___________
   - **発生場所**: ___________
   - **エラーメッセージ**: ___________
   - **対応状況**: ___________

2. **問題の種類**: ___________
   - **発生場所**: ___________
   - **エラーメッセージ**: ___________
   - **対応状況**: ___________

---

## ✅ 確認完了

すべての項目を確認し、問題がないことを確認したら、デプロイは正常に完了しています！

**次回のデプロイ時も、このチェックリストを使用して確認してください。**
